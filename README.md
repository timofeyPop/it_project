MediaPipe
MediaPipe — это библиотека для обработки мультимедийных данных и задач компьютерного зрения в реальном времени. Она предоставляет готовые решения для распознавания и отслеживания объектов на изображении, таких как лицо, руки, поза человека и другие элементы, без необходимости самостоятельного обучения нейронных сетей.
Библиотека работает по принципу конвейера обработки: на вход подаётся изображение или видеокадр, а на выходе формируются структурированные данные, описывающие найденные объекты и их ключевые точки. MediaPipe оптимизирована для работы в реальном времени и может использоваться совместно с OpenCV и другими библиотеками обработки изображений.
MediaPipe предоставляет готовые модули для: обнаружения и отслеживания рук; определения ключевых точек лица; анализа позы тела; сегментации изображений; работы с видео в реальном времени.
Каждый модуль возвращает набор координат и параметров, которые могут быть использованы для дальнейшего анализа или визуализации.
В данном проекте используется модуль MediaPipe Hands, предназначенный для обнаружения руки и определения положения кисти пользователя.
Вызов модуля происходит следующим образом:
with mp_hands.Hands(
    min_detection_confidence=0.7,
    min_tracking_confidence=0.7,
    max_num_hands=1
) as hands:
Обработка кадра происходит с помощью метода
results = hands.process(rgb_frame)
В results хранятся значения контрольных точек кисти (всего 21 точка). Для каждой точки заданы относительные координаты x, y, z на изображении.
 
Рисунок 2. Представление кисти в модели MediaPipe.
Отображение скелета кисти на кадре, полученном из OpenCV, можно сделать следующим методом.
for hand_landmarks in results.multi_hand_landmarks:
    mp_drawing.draw_landmarks(frame, hand_landmarks,
                              mp_hands.HAND_CONNECTIONS)
Обработка жестов.
Для обработки жестов в игре Камень-Ножницы-Бумага анализируется положение только положение 4ех пальцев без большого. Это связано с тем, что большой палец зачастую не формирует жесты игры.
Для каждого из четырёх оставшихся пальцев программа определяет согнут он или нет. Это можно определить по углу в двух суставах пальцев. Если угол в хотя бы одном суставе меньше порогового значения (160 градусов по умолчанию), то палец можно считать согнутым. Такой подход позволяет безошибочно определять жест для любой ориентации кисти.
Например, для указательного пальца просчитываются углы в суставах 6 и 7 (см. рис. 2). Углы в суставах легко посчитать, зная координаты x,y,z контрольных точек, с помощью построения векторов и нахождения их скалярного произведения.
В зависимости от того какие пальцы согнуты, программа определяет один из 3ёх жестов игры, так:
1.	Показан Камень, если все 4 пальца согнуты
2.	Показаны Ножницы, если согнуты только безымянный палец и минизец.
3.	Показана Бумага, если ни один из 4ех пальцев не согнут.
В результате плохого качества изображения, неудобного расположения кисти или шума MediaPipe может неправильно отследить кисть из-за чего испортиться обработка жеста. Для этого используется сглаживание с помощью очереди.
Так, сохраняются последние 5 отслеженных жестов, а итоговый жест получают, выбрав наиболее частый жест в очереди.

Процесс игры
1.	Программа начинается с инициализации веб-камеры, трекера руки и задания параметра раунда (время раунда)
2.	Далее запускается бесконечный цикл, который производит захват изображения с веб-камеры и анализ положения кисти
2.1.	Начинается раунд выбора жеста игрока, который проходит в течении 3 секунд с начала игры. По координатам MediaPipe классифицируется показанный жест и добавляется в буфер последних значений, а текущий выбор игрока формируется как наиболее частый жест в этом буфере.
2.2.	После раунда игрока (3 секунды) случайным образом происходит выбор жеста компьютера. и определения победителя. Результаты игры выводятся на экран, после чего программа ждёт 2 секунды и начинает новую игру – переинициализируем параметры игры, обнуляем время игры и переходим к следующей итерации бесконечного цикла.
Программа выходит из бесконечного цикла, если в конце цикла обнаружена нажатая клавиша ‘q’ на клавиатуре
